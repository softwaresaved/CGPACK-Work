%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
                          S u m m a r y   R e p o r t
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

Compilation
-----------
File     : /home3/y14/y14/di1c13/cgpack/head/cgca_m2hx.f90
Compiled : 02/18/16  16:36:33
Compiler : Version 8.3.7
Ftnlx    : Version 8318 (libcif 83016)
Target   : x86-64
Command  : ftn_driver.exe -hcpu=ivybridge -hstatic -D__CRAYXC
           -D__CRAY_IVYBRIDGE -D__CRAYXT_COMPUTE_LINUX_TARGET -hnetwork=aries
           -c -eacFn -dm -m2 -rl -I/opt/cray/cce/8.3.7/craylibs/x86-64/include
           -I/opt/cray/mpt/7.1.1/gni/mpich2-cray/83/include
           -I/opt/cray/libsci/13.0.1/CRAY/83/sandybridge/include
           -I/opt/cray/rca/1.0.0-2.0502.57212.2.56.ari/include
           -I/opt/cray/alps/5.2.3-2.0502.9295.14.14.ari/include
           -I/opt/cray/xpmem/0.1-2.0502.57015.1.15.ari/include
           -I/opt/cray/gni-headers/4.0-1.0502.10317.9.2.ari/include
           -I/opt/cray/dmapp/7.0.1-1.0502.10246.8.47.ari/include
           -I/opt/cray/pmi/5.0.6-1.0000.10439.140.2.ari/include
           -I/opt/cray/ugni/6.0-1.0502.10245.9.9.ari/include
           -I/opt/cray/udreg/2.3.2-1.0502.9889.2.20.ari/include
           -I/opt/cray/cce/8.3.7/craylibs/x86-64/pkgconfig/../include
           -I/opt/cray/cce/8.3.7/craylibs/x86-64/include
           -I/opt/cray/wlm_detect/1.0-1.0502.57063.1.1.ari/include
           -I/opt/cray/krca/1.0.0-2.0502.57202.2.45.ari/include
           -I/opt/cray-hss-devel/7.2.0/include cgca_m2hx.f90

ftnlx report
------------
Source   : /home3/y14/y14/di1c13/cgpack/head/cgca_m2hx.f90
Date     : 02/18/2016  16:36:35


%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
                          S o u r c e   L i s t i n g
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

    1.    !$Id: cgca_m2hx.f90 176 2015-12-15 16:16:58Z mexas $
    2.    
    3.    !*robodoc*m* CGPACK/cgca_m2hx
    4.    !  NAME
    5.    !    cgca_m2hx
    6.    !  SYNOPSIS
    7.    
    8.    module cgca_m2hx
    9.    
   10.    !  DESCRIPTION
   11.    !    Module dealing with halo exchange
   12.    !  AUTHOR 
   13.    !    Anton Shterenlikht
   14.    !  COPYRIGHT
   15.    !    See CGPACK_Copyright
   16.    !  CONTAINS
   17.    !    cgca_hxi, cgca_hxg
   18.    !  USES
   19.    !    cgca_m1co
   20.    !  USED BY
   21.    !    cgca_m3clvg cgca_m3sld
   22.    !  SOURCE
   23.    
   24.    use cgca_m1co
   25.    implicit none
   26.    
   27.    private
   28.    public :: cgca_hxi, cgca_hxg
   29.    
   30.    contains
   31.    
   32.    !*roboend*
   33.    
   34.    
   35.    !*robodoc*s* cgca_m2hx/cgca_hxi
   36.    !  NAME
   37.    !    cgca_hxi
   38.    !  SYNOPSIS
   39.    
   40.    subroutine cgca_hxi( coarray )
   41.    
   42.    !  INPUT
   43.     
   44.    integer( kind=iarr ), allocatable, intent( inout ) ::                  &
   45.     coarray(:,:,:,:)[:,:,:]
   46.    
   47.    !  SIDE EFFECTS
   48.    !    coarray is changed
   49.    !  DESCRIPTION
   50.    !    This routine does internal halo exchange.
   51.    !    The routine exchanges halos on *all* cell state types.
   52.    !    This is an overkill, as it is likely that only one cell
   53.    !    state type needs to be halo exchanged at a time.
   54.    !    However, it makes for an easier code, and there is virtually
   55.    !    no performance penalty, so we do it this way.
   56.    !  NOTES
   57.    !    All images must call this routine!
   58.    !  USES
   59.    !    parameters from cgca_m1co
   60.    !  USED BY
   61.    !    module cgca_m3clvg: cgca_clgvp
   62.    !  SOURCE
   63.    
   64.    integer ::                                                             &
   65.      lbv(4)      , & ! lower bounds of the "virtual" coarray
   66.      ubv(4)      , & ! upper bounds of the "virtual" coarray
   67.      lbr(4)      , & ! lower bounds of the "real" coarray, lbv+1
   68.      ubr(4)      , & ! upper bounds of the "real" coarray, ubv-1
   69.      lcob(3)     , & ! lower cobounds of the coarray
   70.      ucob(3)     , & ! upper cobounds of the coarray
   71.      imgpos(3)   , & ! position of the image in a coarray grid
   72.      imgpos1mns1 , & ! positions of the neighbouring images
   73.      imgpos1pls1 , & ! along 3 directions
   74.      imgpos2mns1 , & !
   75.      imgpos2pls1 , & !
   76.      imgpos3mns1 , & !
   77.      imgpos3pls1     !
   78.    
   79.    ! check for allocated 
   80.    if ( .not. allocated( coarray ) )                                      &
   81.      error stop "ERROR: cgca_hxi: coarray is not allocated"
   82.    
   83.     lbv = lbound( coarray )
ftn-6205 ftn: VECTOR File = cgca_m2hx.f90, Line = 83 
  A loop starting at line 83 was vectorized with a single vector iteration.

   84.     ubv = ubound( coarray )
ftn-6004 ftn: SCALAR File = cgca_m2hx.f90, Line = 84 
  A loop starting at line 84 was fused with the loop starting at line 83.

   85.     lbr = lbv + 1
ftn-6004 ftn: SCALAR File = cgca_m2hx.f90, Line = 85 
  A loop starting at line 85 was fused with the loop starting at line 83.

   86.     ubr = ubv - 1
ftn-6004 ftn: SCALAR File = cgca_m2hx.f90, Line = 86 
  A loop starting at line 86 was fused with the loop starting at line 83.

   87.    lcob = lcobound( coarray )
ftn-6271 ftn: VECTOR File = cgca_m2hx.f90, Line = 87 
  A loop starting at line 87 was not vectorized because its trip count is too small.

ftn-6008 ftn: SCALAR File = cgca_m2hx.f90, Line = 87 
  A loop starting at line 87 was unwound.

   88.    ucob = ucobound( coarray )
ftn-6004 ftn: SCALAR File = cgca_m2hx.f90, Line = 88 
  A loop starting at line 88 was fused with the loop starting at line 87.

   89.    
   90.         imgpos = this_image( coarray )
ftn-6004 ftn: SCALAR File = cgca_m2hx.f90, Line = 90 
  A loop starting at line 90 was fused with the loop starting at line 87.

   91.    imgpos1mns1 = imgpos(1) - 1
   92.    imgpos1pls1 = imgpos(1) + 1
   93.    imgpos2mns1 = imgpos(2) - 1
   94.    imgpos2pls1 = imgpos(2) + 1
   95.    imgpos3mns1 = imgpos(3) - 1
   96.    imgpos3pls1 = imgpos(3) + 1
   97.    
   98.    ! Make sure only the virtual (halo) arrays are assigned to.
   99.    ! The real array values must never appear on the left
  100.    ! hand side of the assignment expressions.
  101.    ! The halo exchange process is copying real array values into halos.
  102.    ! There must not ever be copying real values
  103.    ! to real, or halo to halo, or halo to real.
  104.    ! Also, only local array must appear on the left.
  105.    ! We are assigning values to the local array's virtual
  106.    ! (halo) cells using values from real cells from arrays
  107.    ! in other images.
  108.    
  109.    ! exchange 2D halos in direction 1
  110.    
  111.    if ( imgpos(1) .ne. lcob(1) )                                          &
  112.      coarray( lbv(1) , lbr(2) : ubr(2) , lbr(3) : ubr(3) , : ) =          &
ftn-6202 ftn: VECTOR File = cgca_m2hx.f90, Line = 112 
  A loop starting at line 112 was replaced by a library call.

  113.      coarray( ubr(1) , lbr(2) : ubr(2) , lbr(3) : ubr(3) , : )            &
  114.        [ imgpos1mns1 , imgpos(2) , imgpos(3) ]
  115.    
  116.    if ( imgpos(1) .ne. ucob(1) )                                          &
  117.      coarray( ubv(1) , lbr(2) : ubr(2) , lbr(3) : ubr(3) , : ) =          &
ftn-6202 ftn: VECTOR File = cgca_m2hx.f90, Line = 117 
  A loop starting at line 117 was replaced by a library call.

  118.      coarray( lbr(1) , lbr(2) : ubr(2) , lbr(3) : ubr(3) , : )            &
  119.        [ imgpos1pls1 , imgpos(2) , imgpos(3) ]
  120.    
  121.    ! exchange 2D halos in direction 2
  122.    
  123.    if ( imgpos(2) .ne. lcob(2) )                                          &
  124.      coarray( lbr(1) : ubr(1) , lbv(2) , lbr(3) : ubr(3) , : ) =          &
ftn-6202 ftn: VECTOR File = cgca_m2hx.f90, Line = 124 
  A loop starting at line 124 was replaced by a library call.

  125.      coarray( lbr(1) : ubr(1) , ubr(2) , lbr(3) : ubr(3) , : )            &
  126.        [ imgpos(1) , imgpos2mns1 , imgpos(3) ]
  127.    
  128.    if ( imgpos(2) .ne. ucob(2) )                                          &
  129.      coarray( lbr(1) : ubr(1) , ubv(2) , lbr(3) : ubr(3) , : ) =          &
ftn-6202 ftn: VECTOR File = cgca_m2hx.f90, Line = 129 
  A loop starting at line 129 was replaced by a library call.

  130.      coarray( lbr(1) : ubr(1) , lbr(2) , lbr(3) : ubr(3) , : )            &
  131.        [ imgpos(1) , imgpos2pls1 , imgpos(3) ]
  132.    
  133.    ! exchange 2D halos in direction 3
  134.    
  135.    if ( imgpos(3) .ne. lcob(3) )                                          &
  136.      coarray( lbr(1) : ubr(1) , lbr(2) : ubr(2) , lbv(3) , : ) =          &
ftn-6202 ftn: VECTOR File = cgca_m2hx.f90, Line = 136 
  A loop starting at line 136 was replaced by a library call.

  137.      coarray( lbr(1) : ubr(1) , lbr(2) : ubr(2) , ubr(3) , : )            &
  138.        [ imgpos(1) , imgpos(2) , imgpos3mns1 ]
  139.    
  140.    if ( imgpos(3) .ne. ucob(3) )                                          &
  141.      coarray( lbr(1) : ubr(1) , lbr(2) : ubr(2) , ubv(3) , : ) =          &
ftn-6202 ftn: VECTOR File = cgca_m2hx.f90, Line = 141 
  A loop starting at line 141 was replaced by a library call.

  142.      coarray( lbr(1) : ubr(1) , lbr(2) : ubr(2) , lbr(3) , : )            &
  143.        [ imgpos(1) , imgpos(2) , imgpos3pls1 ]
  144.    
  145.    ! exchange 1D halos parallel to direction 3
  146.    
  147.    if ( imgpos(1) .ne. lcob(1) .and. imgpos(2) .ne. lcob(2) )             &
  148.      coarray( lbv(1) , lbv(2) , lbr(3) : ubr(3) , : ) =                   &
ftn-6202 ftn: VECTOR File = cgca_m2hx.f90, Line = 148 
  A loop starting at line 148 was replaced by a library call.

  149.      coarray( ubr(1) , ubr(2) , lbr(3) : ubr(3) , : )                     &
  150.        [ imgpos1mns1 , imgpos2mns1 , imgpos(3) ]
  151.    
  152.    if (imgpos(1) .ne. ucob(1) .and. imgpos(2) .ne. lcob(2)) &
  153.      coarray(ubv(1),lbv(2),lbr(3):ubr(3),:) =               &
ftn-6202 ftn: VECTOR File = cgca_m2hx.f90, Line = 153 
  A loop starting at line 153 was replaced by a library call.

  154.      coarray(lbr(1),ubr(2),lbr(3):ubr(3),:)                 &
  155.        [imgpos1pls1,imgpos2mns1,imgpos(3)]
  156.    
  157.    if (imgpos(1) .ne. ucob(1) .and. imgpos(2) .ne. ucob(2)) &
  158.      coarray(ubv(1),ubv(2),lbr(3):ubr(3),:) =               &
ftn-6202 ftn: VECTOR File = cgca_m2hx.f90, Line = 158 
  A loop starting at line 158 was replaced by a library call.

  159.      coarray(lbr(1),lbr(2),lbr(3):ubr(3),:)                 &
  160.        [imgpos1pls1,imgpos2pls1,imgpos(3)]
  161.    
  162.    if (imgpos(1) .ne. lcob(1) .and. imgpos(2) .ne. ucob(2)) &
  163.      coarray(lbv(1),ubv(2),lbr(3):ubr(3),:) =               &
ftn-6202 ftn: VECTOR File = cgca_m2hx.f90, Line = 163 
  A loop starting at line 163 was replaced by a library call.

  164.      coarray(ubr(1),lbr(2),lbr(3):ubr(3),:)                 &
  165.        [imgpos1mns1,imgpos2pls1,imgpos(3)]
  166.    
  167.    ! exchange 1D halos parallel to direction 1
  168.    
  169.    if (imgpos(2) .ne. lcob(2) .and. imgpos(3) .ne. lcob(3)) &
  170.      coarray(lbr(1):ubr(1),lbv(2),lbv(3),:) =               &
ftn-6202 ftn: VECTOR File = cgca_m2hx.f90, Line = 170 
  A loop starting at line 170 was replaced by a library call.

  171.      coarray(lbr(1):ubr(1),ubr(2),ubr(3),:)                 &
  172.        [imgpos(1),imgpos2mns1,imgpos3mns1]
  173.    
  174.    if (imgpos(2) .ne. ucob(2) .and. imgpos(3) .ne. lcob(3)) &
  175.      coarray(lbr(1):ubr(1),ubv(2),lbv(3),:) =               &
ftn-6202 ftn: VECTOR File = cgca_m2hx.f90, Line = 175 
  A loop starting at line 175 was replaced by a library call.

  176.      coarray(lbr(1):ubr(1),lbr(2),ubr(3),:)                 &
  177.        [imgpos(1),imgpos2pls1,imgpos3mns1]
  178.    
  179.    if (imgpos(2) .ne. ucob(2) .and. imgpos(3) .ne. ucob(3)) &
  180.      coarray(lbr(1):ubr(1),ubv(2),ubv(3),:) =               &
ftn-6202 ftn: VECTOR File = cgca_m2hx.f90, Line = 180 
  A loop starting at line 180 was replaced by a library call.

  181.      coarray(lbr(1):ubr(1),lbr(2),lbr(3),:)                 &
  182.        [imgpos(1),imgpos2pls1,imgpos3pls1]
  183.    
  184.    if (imgpos(2) .ne. lcob(2) .and. imgpos(3) .ne. ucob(3)) &
  185.      coarray(lbr(1):ubr(1),lbv(2),ubv(3),:) =               &
ftn-6202 ftn: VECTOR File = cgca_m2hx.f90, Line = 185 
  A loop starting at line 185 was replaced by a library call.

  186.      coarray(lbr(1):ubr(1),ubr(2),lbr(3),:)                 &
  187.        [imgpos(1),imgpos2mns1,imgpos3pls1]
  188.    
  189.    ! exchange 1D halos parallel to direction 2
  190.    
  191.    if (imgpos(1) .ne. lcob(1) .and. imgpos(3) .ne. lcob(3)) &
  192.      coarray(lbv(1),lbr(2):ubr(2),lbv(3),:) =               &
ftn-6202 ftn: VECTOR File = cgca_m2hx.f90, Line = 192 
  A loop starting at line 192 was replaced by a library call.

  193.      coarray(ubr(1),lbr(2):ubr(2),ubr(3),:)                 &
  194.        [imgpos1mns1,imgpos(2),imgpos3mns1]
  195.    
  196.    if (imgpos(1) .ne. ucob(1) .and. imgpos(3) .ne. lcob(3)) &
  197.      coarray(ubv(1),lbr(2):ubr(2),lbv(3),:) =               &
ftn-6202 ftn: VECTOR File = cgca_m2hx.f90, Line = 197 
  A loop starting at line 197 was replaced by a library call.

  198.      coarray(lbr(1),lbr(2):ubr(2),ubr(3),:)                 &
  199.        [imgpos1pls1,imgpos(2),imgpos3mns1]
  200.    
  201.    if (imgpos(1) .ne. ucob(1) .and. imgpos(3) .ne. ucob(3)) &
  202.      coarray(ubv(1),lbr(2):ubr(2),ubv(3),:) =               &
ftn-6202 ftn: VECTOR File = cgca_m2hx.f90, Line = 202 
  A loop starting at line 202 was replaced by a library call.

  203.      coarray(lbr(1),lbr(2):ubr(2),lbr(3),:)                 &
  204.        [imgpos1pls1,imgpos(2),imgpos3pls1]
  205.    
  206.    if (imgpos(1) .ne. lcob(1) .and. imgpos(3) .ne. ucob(3)) &
  207.      coarray(lbv(1),lbr(2):ubr(2),ubv(3),:) =               &
ftn-6202 ftn: VECTOR File = cgca_m2hx.f90, Line = 207 
  A loop starting at line 207 was replaced by a library call.

  208.      coarray(ubr(1),lbr(2):ubr(2),lbr(3),:)                 &
  209.        [imgpos1mns1,imgpos(2),imgpos3pls1]
  210.    
  211.    ! exchange 8 scalar halos
  212.    ! first 4 statements are for the lower bound virtual
  213.    ! corners of the coarray along dimension 3.
  214.    
  215.    if ((imgpos(1) .ne. lcob(1)) .and. (imgpos(2) .ne. lcob(2)) .and.      &
  216.        (imgpos(3) .ne. lcob(3)))                                          &
  217.      coarray(lbv(1),lbv(2),lbv(3),:) =                                    &
ftn-6202 ftn: VECTOR File = cgca_m2hx.f90, Line = 217 
  A loop starting at line 217 was replaced by a library call.

  218.      coarray(ubr(1),ubr(2),ubr(3),:)[imgpos1mns1,imgpos2mns1,imgpos3mns1]
  219.    
  220.    if ((imgpos(1) .ne. ucob(1)) .and. (imgpos(2) .ne. lcob(2)) .and.      &
  221.        (imgpos(3) .ne. lcob(3)))                                          &
  222.      coarray(ubv(1),lbv(2),lbv(3),:) =                                    &
ftn-6202 ftn: VECTOR File = cgca_m2hx.f90, Line = 222 
  A loop starting at line 222 was replaced by a library call.

  223.      coarray(lbr(1),ubr(2),ubr(3),:)[imgpos1pls1,imgpos2mns1,imgpos3mns1]
  224.    
  225.    if ((imgpos(1) .ne. lcob(1)) .and. (imgpos(2) .ne. ucob(2)) .and.      &
  226.        (imgpos(3) .ne. lcob(3)))                                          &
  227.      coarray(lbv(1),ubv(2),lbv(3),:) =                                    &
ftn-6202 ftn: VECTOR File = cgca_m2hx.f90, Line = 227 
  A loop starting at line 227 was replaced by a library call.

  228.      coarray(ubr(1),lbr(2),ubr(3),:)[imgpos1mns1,imgpos2pls1,imgpos3mns1]
  229.    
  230.    if ((imgpos(1) .ne. ucob(1)) .and. (imgpos(2) .ne. ucob(2)) .and.      &
  231.        (imgpos(3) .ne. lcob(3)))                                          &
  232.      coarray(ubv(1),ubv(2),lbv(3),:) =                                    &
ftn-6202 ftn: VECTOR File = cgca_m2hx.f90, Line = 232 
  A loop starting at line 232 was replaced by a library call.

  233.      coarray(lbr(1),lbr(2),ubr(3),:)[imgpos1pls1,imgpos2pls1,imgpos3mns1]
  234.    
  235.    ! these 4 statements are for the uppper bound virtual
  236.    ! corners of the coarray along dimension 3.
  237.    
  238.    if ((imgpos(1) .ne. lcob(1)) .and. (imgpos(2) .ne. lcob(2)) .and.      &
  239.        (imgpos(3) .ne. ucob(3)))                                          &
  240.      coarray(lbv(1),lbv(2),ubv(3),:) =                                    &
ftn-6202 ftn: VECTOR File = cgca_m2hx.f90, Line = 240 
  A loop starting at line 240 was replaced by a library call.

  241.      coarray(ubr(1),ubr(2),lbr(3),:)[imgpos1mns1,imgpos2mns1,imgpos3pls1]
  242.    
  243.    if ((imgpos(1) .ne. ucob(1)) .and. (imgpos(2) .ne. lcob(2)) .and.      &
  244.        (imgpos(3) .ne. ucob(3)))                                          &
  245.      coarray(ubv(1),lbv(2),ubv(3),:) =                                    &
ftn-6202 ftn: VECTOR File = cgca_m2hx.f90, Line = 245 
  A loop starting at line 245 was replaced by a library call.

  246.      coarray(lbr(1),ubr(2),lbr(3),:)[imgpos1pls1,imgpos2mns1,imgpos3pls1]
  247.    
  248.    if ((imgpos(1) .ne. lcob(1)) .and. (imgpos(2) .ne. ucob(2)) .and.      &
  249.        (imgpos(3) .ne. ucob(3)))                                          &
  250.      coarray(lbv(1),ubv(2),ubv(3),:) =                                    &
ftn-6202 ftn: VECTOR File = cgca_m2hx.f90, Line = 250 
  A loop starting at line 250 was replaced by a library call.

  251.      coarray(ubr(1),lbr(2),lbr(3),:)[imgpos1mns1,imgpos2pls1,imgpos3pls1]
  252.    
  253.    if ((imgpos(1) .ne. ucob(1)) .and. (imgpos(2) .ne. ucob(2)) .and.      &
  254.        (imgpos(3) .ne. ucob(3)))                                          &
  255.      coarray(ubv(1),ubv(2),ubv(3),:) =                                    &
ftn-6202 ftn: VECTOR File = cgca_m2hx.f90, Line = 255 
  A loop starting at line 255 was replaced by a library call.

  256.      coarray(lbr(1),lbr(2),lbr(3),:)[imgpos1pls1,imgpos2pls1,imgpos3pls1]
  257.    
  258.    end subroutine cgca_hxi
  259.    
  260.    !*roboend*
  261.    
  262.    
  263.    !*robodoc*s* cgca_m2hx/cgca_hxg
  264.    !  NAME
  265.    !    cgca_hxg
  266.    !  SYNOPSIS
  267.    
  268.    subroutine cgca_hxg(coarray)
  269.    
  270.    !  INPUT
  271.    
  272.    integer(kind=iarr),allocatable,intent(inout) :: coarray(:,:,:,:)[:,:,:]
  273.    
  274.    !  SIDE EFFECTS
  275.    !    coarray is changed
  276.    !  DESCRIPTION
  277.    !    This routine does the global halo exchange, i.e. on the
  278.    !    boundaries of the whole model.
  279.    !    In other wordsl it imposes self-similar boundary conditions on
  280.    !    the global (super) array.
  281.    !    The routine exchanges halos on *all* cell state types.
  282.    !    This is an overkill, as it is likely that only one cell
  283.    !    state type needs to be halo exchanged at a time.
  284.    !    However, it makes for an easier code, and there is
  285.    !    virtually no performance penaly, so we do it this way.
  286.    !  NOTES
  287.    !    All images must call this routine!
  288.    !  USES
  289.    !    none
  290.    !  USED BY
  291.    !    module cgca_m3clvg: cgca_clvgp
  292.    !  SOURCE
  293.    
  294.    integer(kind=idef) :: &
  295.      lbv(4)      , & ! lower bounds of the "virtual" coarray
  296.      ubv(4)      , & ! upper bounds of the "virtual" coarray
  297.      lbr(4)      , & ! lower bounds of the "real" coarray, lbv+1
  298.      ubr(4)      , & ! upper bounds of the "real" coarray, ubv-1
  299.      lcob(3)     , & ! lower cobounds of the coarray
  300.      ucob(3)     , & ! upper cobounds of the coarray
  301.      imgpos(3)   , & ! position of the image in a coarray grid
  302.      imgpos1mns1 , & ! positions of the neighbouring images
  303.      imgpos1pls1 , & ! along 3 directions
  304.      imgpos2mns1 , & !
  305.      imgpos2pls1 , & !
  306.      imgpos3mns1 , & !
  307.      imgpos3pls1 , & !
  308.      z1,z2,z3        ! temp vars to store coarray grid coordinates 
  309.    
  310.    ! check for allocated 
  311.    if (.not. allocated(coarray)) &
  312.      error stop "ERROR: cgca_hlg: coarray is not allocated"
  313.    
  314.    lbv=lbound(coarray)
ftn-6205 ftn: VECTOR File = cgca_m2hx.f90, Line = 314 
  A loop starting at line 314 was vectorized with a single vector iteration.

  315.    ubv=ubound(coarray)
ftn-6004 ftn: SCALAR File = cgca_m2hx.f90, Line = 315 
  A loop starting at line 315 was fused with the loop starting at line 314.

  316.    lbr=lbv+1
ftn-6004 ftn: SCALAR File = cgca_m2hx.f90, Line = 316 
  A loop starting at line 316 was fused with the loop starting at line 314.

  317.    ubr=ubv-1
ftn-6004 ftn: SCALAR File = cgca_m2hx.f90, Line = 317 
  A loop starting at line 317 was fused with the loop starting at line 314.

  318.    lcob=lcobound(coarray)
ftn-6271 ftn: VECTOR File = cgca_m2hx.f90, Line = 318 
  A loop starting at line 318 was not vectorized because its trip count is too small.

ftn-6008 ftn: SCALAR File = cgca_m2hx.f90, Line = 318 
  A loop starting at line 318 was unwound.

  319.    ucob=ucobound(coarray)
ftn-6004 ftn: SCALAR File = cgca_m2hx.f90, Line = 319 
  A loop starting at line 319 was fused with the loop starting at line 318.

  320.    
  321.    imgpos=this_image(coarray)
ftn-6004 ftn: SCALAR File = cgca_m2hx.f90, Line = 321 
  A loop starting at line 321 was fused with the loop starting at line 318.

  322.    imgpos1mns1=imgpos(1)-1
  323.    imgpos1pls1=imgpos(1)+1
  324.    imgpos2mns1=imgpos(2)-1
  325.    imgpos2pls1=imgpos(2)+1
  326.    imgpos3mns1=imgpos(3)-1
  327.    imgpos3pls1=imgpos(3)+1
  328.    
  329.    ! Make sure only the virtual (halo) arrays are assigned to.
  330.    ! The real array values must never appear on the left
  331.    ! hand side of the assignment expressions.
  332.    ! The halo exchange process is copying real array values
  333.    ! into halos. There must not ever be copying of real values
  334.    ! to real, or halo to halo, or halo to real.
  335.    
  336.    !**************************************
  337.    ! 2D halos
  338.    !**************************************
  339.    
  340.    ! exchange 2D halos in direction 1
  341.    
  342.    if (imgpos(1) .eq. lcob(1))                          &
  343.      coarray(lbv(1),lbr(2):ubr(2),lbr(3):ubr(3),:) =    &
ftn-6202 ftn: VECTOR File = cgca_m2hx.f90, Line = 343 
  A loop starting at line 343 was replaced by a library call.

  344.      coarray(ubr(1),lbr(2):ubr(2),lbr(3):ubr(3),:)      &
  345.        [ucob(1),imgpos(2),imgpos(3)]
  346.    
  347.    if (imgpos(1) .eq. ucob(1))                          &
  348.      coarray(ubv(1),lbr(2):ubr(2),lbr(3):ubr(3),:) =    &
ftn-6202 ftn: VECTOR File = cgca_m2hx.f90, Line = 348 
  A loop starting at line 348 was replaced by a library call.

  349.      coarray(lbr(1),lbr(2):ubr(2),lbr(3):ubr(3),:)      &
  350.        [lcob(1),imgpos(2),imgpos(3)]
  351.    
  352.    ! exchange 2D halos in direction 2
  353.    
  354.    if (imgpos(2) .eq. lcob(2))                          &
  355.      coarray(lbr(1):ubr(1),lbv(2),lbr(3):ubr(3),:) =    &
ftn-6202 ftn: VECTOR File = cgca_m2hx.f90, Line = 355 
  A loop starting at line 355 was replaced by a library call.

  356.      coarray(lbr(1):ubr(1),ubr(2),lbr(3):ubr(3),:)      &
  357.        [imgpos(1),ucob(2),imgpos(3)]
  358.    
  359.    if (imgpos(2) .eq. ucob(2))                          &
  360.      coarray(lbr(1):ubr(1),ubv(2),lbr(3):ubr(3),:) =    &
ftn-6202 ftn: VECTOR File = cgca_m2hx.f90, Line = 360 
  A loop starting at line 360 was replaced by a library call.

  361.      coarray(lbr(1):ubr(1),lbr(2),lbr(3):ubr(3),:)      &
  362.        [imgpos(1),lcob(2),imgpos(3)]
  363.    
  364.    ! exchange 2D halos in direction 3
  365.    
  366.    if (imgpos(3) .eq. lcob(3))                          &
  367.      coarray(lbr(1):ubr(1),lbr(2):ubr(2),lbv(3),:) =    &
ftn-6202 ftn: VECTOR File = cgca_m2hx.f90, Line = 367 
  A loop starting at line 367 was replaced by a library call.

  368.      coarray(lbr(1):ubr(1),lbr(2):ubr(2),ubr(3),:)      &
  369.        [imgpos(1),imgpos(2),ucob(3)]
  370.    
  371.    if (imgpos(3) .eq. ucob(3))                          &
  372.      coarray(lbr(1):ubr(1),lbr(2):ubr(2),ubv(3),:) =    &
ftn-6202 ftn: VECTOR File = cgca_m2hx.f90, Line = 372 
  A loop starting at line 372 was replaced by a library call.

  373.      coarray(lbr(1):ubr(1),lbr(2):ubr(2),lbr(3),:)      &
  374.        [imgpos(1),imgpos(2),lcob(3)]
  375.    
  376.    !**************************************
  377.    ! 1D halos
  378.    !**************************************
  379.    
  380.    ! exchange 1D halos parallel to direction 3
  381.    ! the 4 edges of the super array
  382.    
  383.    ! operation 1
  384.    if (imgpos(1) .eq. lcob(1) .and. imgpos(2) .eq. lcob(2))               &
  385.      coarray(lbv(1),lbv(2),lbr(3):ubr(3),:) =                             &
ftn-6202 ftn: VECTOR File = cgca_m2hx.f90, Line = 385 
  A loop starting at line 385 was replaced by a library call.

  386.      coarray(ubr(1),ubr(2),lbr(3):ubr(3),:) [ucob(1),ucob(2),imgpos(3)]
  387.    
  388.    ! operation 2
  389.    if (imgpos(1) .eq. ucob(1) .and. imgpos(2) .eq. lcob(2))               &
  390.      coarray(ubv(1),lbv(2),lbr(3):ubr(3),:) =                             &
ftn-6202 ftn: VECTOR File = cgca_m2hx.f90, Line = 390 
  A loop starting at line 390 was replaced by a library call.

  391.      coarray(lbr(1),ubr(2),lbr(3):ubr(3),:) [lcob(1),ucob(2),imgpos(3)]
  392.    
  393.    ! operation 3
  394.    if (imgpos(1) .eq. ucob(1) .and. imgpos(2) .eq. ucob(2))               &
  395.      coarray(ubv(1),ubv(2),lbr(3):ubr(3),:) =                             &
ftn-6202 ftn: VECTOR File = cgca_m2hx.f90, Line = 395 
  A loop starting at line 395 was replaced by a library call.

  396.      coarray(lbr(1),lbr(2),lbr(3):ubr(3),:) [lcob(1),lcob(2),imgpos(3)]
  397.    
  398.    ! operation 4
  399.    if (imgpos(1) .eq. lcob(1) .and. imgpos(2) .eq. ucob(2))               &
  400.      coarray(lbv(1),ubv(2),lbr(3):ubr(3),:) =                             &
ftn-6202 ftn: VECTOR File = cgca_m2hx.f90, Line = 400 
  A loop starting at line 400 was replaced by a library call.

  401.      coarray(ubr(1),lbr(2),lbr(3):ubr(3),:) [ucob(1),lcob(2),imgpos(3)]
  402.    
  403.    ! exchange 1D halos parallel to direction 3
  404.    ! all intermediate edges, self-similarity along 1
  405.    
  406.    ! operation 5
  407.    if (imgpos(1) .eq. lcob(1) .and. imgpos(2) .ne. ucob(2))               &
  408.      coarray(lbv(1),ubv(2),lbr(3):ubr(3),:) =                             &
ftn-6202 ftn: VECTOR File = cgca_m2hx.f90, Line = 408 
  A loop starting at line 408 was replaced by a library call.

  409.      coarray(ubr(1),lbr(2),lbr(3):ubr(3),:) [ucob(1),imgpos2pls1,imgpos(3)]
  410.    
  411.    ! operation 6
  412.    if (imgpos(1) .eq. lcob(1) .and. imgpos(2) .ne. lcob(2))               &
  413.      coarray(lbv(1),lbv(2),lbr(3):ubr(3),:) =                             &
ftn-6202 ftn: VECTOR File = cgca_m2hx.f90, Line = 413 
  A loop starting at line 413 was replaced by a library call.

  414.      coarray(ubr(1),ubr(2),lbr(3):ubr(3),:) [ucob(1),imgpos2mns1,imgpos(3)]
  415.    
  416.    ! operation 7
  417.    if (imgpos(1) .eq. ucob(1) .and. imgpos(2) .ne. ucob(2))               &
  418.      coarray(ubv(1),ubv(2),lbr(3):ubr(3),:) =                             &
ftn-6202 ftn: VECTOR File = cgca_m2hx.f90, Line = 418 
  A loop starting at line 418 was replaced by a library call.

  419.      coarray(lbr(1),lbr(2),lbr(3):ubr(3),:) [lcob(1),imgpos2pls1,imgpos(3)]
  420.    
  421.    ! operation 8
  422.    if (imgpos(1) .eq. ucob(1) .and. imgpos(2) .ne. lcob(2))               &
  423.      coarray(ubv(1),lbv(2),lbr(3):ubr(3),:) =                             &
ftn-6202 ftn: VECTOR File = cgca_m2hx.f90, Line = 423 
  A loop starting at line 423 was replaced by a library call.

  424.      coarray(lbr(1),ubr(2),lbr(3):ubr(3),:) [lcob(1),imgpos2mns1,imgpos(3)]
  425.    
  426.    ! exchange 1D halos parallel to direction 3
  427.    ! all intermediate edges, self-similarity along 2
  428.    
  429.    ! operation 9
  430.    if (imgpos(1) .ne. ucob(1) .and. imgpos(2) .eq. lcob(2))               &
  431.      coarray(ubv(1),lbv(2),lbr(3):ubr(3),:) =                             &
ftn-6202 ftn: VECTOR File = cgca_m2hx.f90, Line = 431 
  A loop starting at line 431 was replaced by a library call.

  432.      coarray(lbr(1),ubr(2),lbr(3):ubr(3),:) [imgpos1pls1,ucob(2),imgpos(3)]
  433.    
  434.    ! operation 10
  435.    if (imgpos(1) .ne. lcob(1) .and. imgpos(2) .eq. lcob(2))               &
  436.      coarray(lbv(1),lbv(2),lbr(3):ubr(3),:) =                             &
ftn-6202 ftn: VECTOR File = cgca_m2hx.f90, Line = 436 
  A loop starting at line 436 was replaced by a library call.

  437.      coarray(ubr(1),ubr(2),lbr(3):ubr(3),:) [imgpos1mns1,ucob(2),imgpos(3)]
  438.    
  439.    ! operation 11
  440.    if (imgpos(1) .ne. ucob(1) .and. imgpos(2) .eq. ucob(2))               &
  441.      coarray(ubv(1),ubv(2),lbr(3):ubr(3),:) =                             &
ftn-6202 ftn: VECTOR File = cgca_m2hx.f90, Line = 441 
  A loop starting at line 441 was replaced by a library call.

  442.      coarray(lbr(1),lbr(2),lbr(3):ubr(3),:) [imgpos1pls1,lcob(2),imgpos(3)]
  443.    
  444.    ! operation 12
  445.    if (imgpos(1) .ne. lcob(1) .and. imgpos(2) .eq. ucob(2))               &
  446.      coarray(lbv(1),ubv(2),lbr(3):ubr(3),:) =                             &
ftn-6202 ftn: VECTOR File = cgca_m2hx.f90, Line = 446 
  A loop starting at line 446 was replaced by a library call.

  447.      coarray(ubr(1),lbr(2),lbr(3):ubr(3),:) [imgpos1mns1,lcob(2),imgpos(3)]
  448.    
  449.    ! exchange 1D halos parallel to direction 1
  450.    ! the 4 edges of the super array
  451.    
  452.    ! operation 1
  453.    if (imgpos(2) .eq. lcob(2) .and. imgpos(3) .eq. lcob(3))               &
  454.      coarray(lbr(1):ubr(1),lbv(2),lbv(3),:) =                             &
ftn-6202 ftn: VECTOR File = cgca_m2hx.f90, Line = 454 
  A loop starting at line 454 was replaced by a library call.

  455.      coarray(lbr(1):ubr(1),ubr(2),ubr(3),:) [imgpos(1),ucob(2),ucob(3)]
  456.    
  457.    ! operation 2
  458.    if (imgpos(2) .eq. ucob(2) .and. imgpos(3) .eq. lcob(3))               &
  459.      coarray(lbr(1):ubr(1),ubv(2),lbv(3),:) =                             &
ftn-6202 ftn: VECTOR File = cgca_m2hx.f90, Line = 459 
  A loop starting at line 459 was replaced by a library call.

  460.      coarray(lbr(1):ubr(1),lbr(2),ubr(3),:) [imgpos(1),lcob(2),ucob(3)]
  461.    
  462.    ! operation 3 
  463.    if (imgpos(2) .eq. ucob(2) .and. imgpos(3) .eq. ucob(3))               &
  464.      coarray(lbr(1):ubr(1),ubv(2),ubv(3),:) =                             &
ftn-6202 ftn: VECTOR File = cgca_m2hx.f90, Line = 464 
  A loop starting at line 464 was replaced by a library call.

  465.      coarray(lbr(1):ubr(1),lbr(2),lbr(3),:) [imgpos(1),lcob(2),lcob(3)]
  466.    
  467.    ! operation 4
  468.    if (imgpos(2) .eq. lcob(2) .and. imgpos(3) .eq. ucob(3))               &
  469.      coarray(lbr(1):ubr(1),lbv(2),ubv(3),:) =                             &
ftn-6202 ftn: VECTOR File = cgca_m2hx.f90, Line = 469 
  A loop starting at line 469 was replaced by a library call.

  470.      coarray(lbr(1):ubr(1),ubr(2),lbr(3),:) [imgpos(1),ucob(2),lcob(3)]
  471.    
  472.    ! exchange 1D halos parallel to direction 1
  473.    ! intermediate edges, self-similarity along 2
  474.    
  475.    ! operation 5
  476.    if (imgpos(2) .eq. lcob(2) .and. imgpos(3) .ne. ucob(3))               &
  477.      coarray(lbr(1):ubr(1),lbv(2),ubv(3),:) =                             &
ftn-6202 ftn: VECTOR File = cgca_m2hx.f90, Line = 477 
  A loop starting at line 477 was replaced by a library call.

  478.      coarray(lbr(1):ubr(1),ubr(2),lbr(3),:) [imgpos(1),ucob(2),imgpos3pls1]
  479.    
  480.    ! operation 6
  481.    if (imgpos(2) .eq. lcob(2) .and. imgpos(3) .ne. lcob(3))               &
  482.      coarray(lbr(1):ubr(1),lbv(2),lbv(3),:) =                             &
ftn-6202 ftn: VECTOR File = cgca_m2hx.f90, Line = 482 
  A loop starting at line 482 was replaced by a library call.

  483.      coarray(lbr(1):ubr(1),ubr(2),ubr(3),:) [imgpos(1),ucob(2),imgpos3mns1]
  484.    
  485.    ! operation 7
  486.    if (imgpos(2) .eq. ucob(2) .and. imgpos(3) .ne. ucob(3))               &
  487.      coarray(lbr(1):ubr(1),ubv(2),ubv(3),:) =                             &
ftn-6202 ftn: VECTOR File = cgca_m2hx.f90, Line = 487 
  A loop starting at line 487 was replaced by a library call.

  488.      coarray(lbr(1):ubr(1),lbr(2),lbr(3),:) [imgpos(1),lcob(2),imgpos3pls1]
  489.    
  490.    ! operation 8
  491.    if (imgpos(2) .eq. ucob(2) .and. imgpos(3) .ne. lcob(3))               &
  492.      coarray(lbr(1):ubr(1),ubv(2),lbv(3),:) =                             &
ftn-6202 ftn: VECTOR File = cgca_m2hx.f90, Line = 492 
  A loop starting at line 492 was replaced by a library call.

  493.      coarray(lbr(1):ubr(1),lbr(2),ubr(3),:) [imgpos(1),lcob(2),imgpos3mns1]
  494.    
  495.    ! exchange 1D halos parallel to direction 1
  496.    ! intermediate edges, self-similarity along 3
  497.    
  498.    ! operation 9
  499.    if (imgpos(2) .ne. ucob(2) .and. imgpos(3) .eq. lcob(3))               &
  500.      coarray(lbr(1):ubr(1),ubv(2),lbv(3),:) =                             &
ftn-6202 ftn: VECTOR File = cgca_m2hx.f90, Line = 500 
  A loop starting at line 500 was replaced by a library call.

  501.      coarray(lbr(1):ubr(1),lbr(2),ubr(3),:) [imgpos(1),imgpos2pls1,ucob(3)]
  502.    
  503.    ! operation 10
  504.    if (imgpos(2) .ne. lcob(2) .and. imgpos(3) .eq. lcob(3))               &
  505.      coarray(lbr(1):ubr(1),lbv(2),lbv(3),:) =                             &
ftn-6202 ftn: VECTOR File = cgca_m2hx.f90, Line = 505 
  A loop starting at line 505 was replaced by a library call.

  506.      coarray(lbr(1):ubr(1),ubr(2),ubr(3),:) [imgpos(1),imgpos2mns1,ucob(3)]
  507.    
  508.    ! operation 11
  509.    if (imgpos(2) .ne. ucob(2) .and. imgpos(3) .eq. ucob(3))               &
  510.      coarray(lbr(1):ubr(1),ubv(2),ubv(3),:) =                             &
ftn-6202 ftn: VECTOR File = cgca_m2hx.f90, Line = 510 
  A loop starting at line 510 was replaced by a library call.

  511.      coarray(lbr(1):ubr(1),lbr(2),lbr(3),:) [imgpos(1),imgpos2pls1,lcob(3)]
  512.    
  513.    ! operation 12
  514.    if (imgpos(2) .ne. lcob(2) .and. imgpos(3) .eq. ucob(3))               &
  515.      coarray(lbr(1):ubr(1),lbv(2),ubv(3),:) =                             &
ftn-6202 ftn: VECTOR File = cgca_m2hx.f90, Line = 515 
  A loop starting at line 515 was replaced by a library call.

  516.      coarray(lbr(1):ubr(1),ubr(2),lbr(3),:) [imgpos(1),imgpos2mns1,lcob(3)]
  517.    
  518.    ! exchange 1D halos parallel to direction 2
  519.    ! the 4 edges of the super array
  520.    
  521.    ! operation 1
  522.    if (imgpos(1) .eq. lcob(1) .and. imgpos(3) .eq. lcob(3))               &
  523.      coarray(lbv(1),lbr(2):ubr(2),lbv(3),:) =                             &
ftn-6202 ftn: VECTOR File = cgca_m2hx.f90, Line = 523 
  A loop starting at line 523 was replaced by a library call.

  524.      coarray(ubr(1),lbr(2):ubr(2),ubr(3),:) [ucob(1),imgpos(2),ucob(3)]
  525.    
  526.    ! operation 2
  527.    if (imgpos(1) .eq. lcob(1) .and. imgpos(3) .eq. ucob(3))               &
  528.      coarray(lbv(1),lbr(2):ubr(2),ubv(3),:) =                             &
ftn-6202 ftn: VECTOR File = cgca_m2hx.f90, Line = 528 
  A loop starting at line 528 was replaced by a library call.

  529.      coarray(ubr(1),lbr(2):ubr(2),lbr(3),:) [ucob(1),imgpos(2),lcob(3)]
  530.    
  531.    ! operation 3
  532.    if (imgpos(1) .eq. ucob(1) .and. imgpos(3) .eq. ucob(3))               &
  533.      coarray(ubv(1),lbr(2):ubr(2),ubv(3),:) =                             &
ftn-6202 ftn: VECTOR File = cgca_m2hx.f90, Line = 533 
  A loop starting at line 533 was replaced by a library call.

  534.      coarray(lbr(1),lbr(2):ubr(2),lbr(3),:) [lcob(1),imgpos(2),lcob(3)]
  535.    
  536.    ! operation 4
  537.    if (imgpos(1) .eq. ucob(1) .and. imgpos(3) .eq. lcob(3))               &
  538.      coarray(ubv(1),lbr(2):ubr(2),lbv(3),:) =                             &
ftn-6202 ftn: VECTOR File = cgca_m2hx.f90, Line = 538 
  A loop starting at line 538 was replaced by a library call.

  539.      coarray(lbr(1),lbr(2):ubr(2),ubr(3),:) [lcob(1),imgpos(2),ucob(3)]
  540.    
  541.    ! exchange 1D halos parallel to direction 2
  542.    ! intermediate edges, self-similarity along 3
  543.    
  544.    ! operation 5
  545.    if (imgpos(1) .ne. ucob(1) .and. imgpos(3) .eq. lcob(3))               &
  546.      coarray(ubv(1),lbr(2):ubr(2),lbv(3),:) =                             &
ftn-6202 ftn: VECTOR File = cgca_m2hx.f90, Line = 546 
  A loop starting at line 546 was replaced by a library call.

  547.      coarray(lbr(1),lbr(2):ubr(2),ubr(3),:) [imgpos1pls1,imgpos(2),ucob(3)]
  548.    
  549.    ! operation 6
  550.    if (imgpos(1) .ne. lcob(1) .and. imgpos(3) .eq. lcob(3))               &
  551.      coarray(lbv(1),lbr(2):ubr(2),lbv(3),:) =                             &
ftn-6202 ftn: VECTOR File = cgca_m2hx.f90, Line = 551 
  A loop starting at line 551 was replaced by a library call.

  552.      coarray(ubr(1),lbr(2):ubr(2),ubr(3),:) [imgpos1mns1,imgpos(2),ucob(3)]
  553.    
  554.    ! operation 7
  555.    if (imgpos(1) .ne. ucob(1) .and. imgpos(3) .eq. ucob(3))               &
  556.      coarray(ubv(1),lbr(2):ubr(2),ubv(3),:) =                             &
ftn-6202 ftn: VECTOR File = cgca_m2hx.f90, Line = 556 
  A loop starting at line 556 was replaced by a library call.

  557.      coarray(lbr(1),lbr(2):ubr(2),lbr(3),:) [imgpos1pls1,imgpos(2),lcob(3)]
  558.    
  559.    ! operation 8
  560.    if (imgpos(1) .ne. lcob(1) .and. imgpos(3) .eq. ucob(3))               &
  561.      coarray(lbv(1),lbr(2):ubr(2),ubv(3),:) =                             &
ftn-6202 ftn: VECTOR File = cgca_m2hx.f90, Line = 561 
  A loop starting at line 561 was replaced by a library call.

  562.      coarray(ubr(1),lbr(2):ubr(2),lbr(3),:) [imgpos1mns1,imgpos(2),lcob(3)]
  563.    
  564.    ! exchange 1D halos parallel to direction 2
  565.    ! intermediate edges, self-similarity along 1
  566.    
  567.    ! operation 9
  568.    if (imgpos(1) .eq. lcob(1) .and. imgpos(3) .ne. ucob(3))               &
  569.      coarray(lbv(1),lbr(2):ubr(2),ubv(3),:) =                             &
ftn-6202 ftn: VECTOR File = cgca_m2hx.f90, Line = 569 
  A loop starting at line 569 was replaced by a library call.

  570.      coarray(ubr(1),lbr(2):ubr(2),lbr(3),:) [ucob(1),imgpos(2),imgpos3pls1]
  571.    
  572.    ! operation 10
  573.    if (imgpos(1) .eq. lcob(1) .and. imgpos(3) .ne. lcob(3))               &
  574.      coarray(lbv(1),lbr(2):ubr(2),lbv(3),:) =                             &
ftn-6202 ftn: VECTOR File = cgca_m2hx.f90, Line = 574 
  A loop starting at line 574 was replaced by a library call.

  575.      coarray(ubr(1),lbr(2):ubr(2),ubr(3),:) [ucob(1),imgpos(2),imgpos3mns1]
  576.    
  577.    ! operation 11
  578.    if (imgpos(1) .eq. ucob(1) .and. imgpos(3) .ne. ucob(3))               &
  579.      coarray(ubv(1),lbr(2):ubr(2),ubv(3),:) =                             &
ftn-6202 ftn: VECTOR File = cgca_m2hx.f90, Line = 579 
  A loop starting at line 579 was replaced by a library call.

  580.      coarray(lbr(1),lbr(2):ubr(2),lbr(3),:) [lcob(1),imgpos(2),imgpos3pls1]
  581.    
  582.    ! operation 12
  583.    if (imgpos(1) .eq. ucob(1) .and. imgpos(3) .ne. lcob(3))               &
  584.      coarray(ubv(1),lbr(2):ubr(2),lbv(3),:) =                             &
ftn-6202 ftn: VECTOR File = cgca_m2hx.f90, Line = 584 
  A loop starting at line 584 was replaced by a library call.

  585.      coarray(lbr(1),lbr(2):ubr(2),ubr(3),:) [lcob(1),imgpos(2),imgpos3mns1]
  586.    
  587.    !**************************************
  588.    ! corner halos
  589.    !**************************************
  590.    
  591.    ! corner 1
  592.    if (imgpos(1) .eq. lcob(1) .or.             &
  593.        imgpos(2) .eq. lcob(2) .or.             &
  594.        imgpos(3) .eq. lcob(3))                 &
  595.    then
  596.      z1 = imgpos1mns1
  597.      z2 = imgpos2mns1
  598.      z3 = imgpos3mns1
  599.      if (z1 .lt. lcob(1)) z1 = ucob(1)
  600.      if (z2 .lt. lcob(2)) z2 = ucob(2)
  601.      if (z3 .lt. lcob(3)) z3 = ucob(3)
  602.      coarray(lbv(1),lbv(2),lbv(3),:) =         &
ftn-6202 ftn: VECTOR File = cgca_m2hx.f90, Line = 602 
  A loop starting at line 602 was replaced by a library call.

  603.      coarray(ubr(1),ubr(2),ubr(3),:) [z1,z2,z3]
  604.    end if
  605.    
  606.    ! corner 2
  607.    if (imgpos(1) .eq. ucob(1) .or.             &
  608.        imgpos(2) .eq. lcob(2) .or.             &
  609.        imgpos(3) .eq. lcob(3))                 &
  610.    then
  611.      z1 = imgpos1pls1
  612.      z2 = imgpos2mns1
  613.      z3 = imgpos3mns1
  614.      if (z1 .gt. ucob(1)) z1 = lcob(1)
  615.      if (z2 .lt. lcob(2)) z2 = ucob(2)
  616.      if (z3 .lt. lcob(3)) z3 = ucob(3)
  617.      coarray(ubv(1),lbv(2),lbv(3),:) =         &
ftn-6202 ftn: VECTOR File = cgca_m2hx.f90, Line = 617 
  A loop starting at line 617 was replaced by a library call.

  618.      coarray(lbr(1),ubr(2),ubr(3),:) [z1,z2,z3]
  619.    end if
  620.    
  621.    ! corner 3
  622.    if (imgpos(1) .eq. lcob(1) .or.             &
  623.        imgpos(2) .eq. ucob(2) .or.             &
  624.        imgpos(3) .eq. lcob(3))                 &
  625.    then
  626.      z1 = imgpos1mns1
  627.      z2 = imgpos2pls1
  628.      z3 = imgpos3mns1
  629.      if (z1 .lt. lcob(1)) z1 = ucob(1)
  630.      if (z2 .gt. ucob(2)) z2 = lcob(2)
  631.      if (z3 .lt. lcob(3)) z3 = ucob(3)
  632.      coarray(lbv(1),ubv(2),lbv(3),:) =         &
ftn-6202 ftn: VECTOR File = cgca_m2hx.f90, Line = 632 
  A loop starting at line 632 was replaced by a library call.

  633.      coarray(ubr(1),lbr(2),ubr(3),:) [z1,z2,z3]
  634.    end if
  635.    
  636.    ! corner 4
  637.    if (imgpos(1) .eq. ucob(1) .or.             &
  638.        imgpos(2) .eq. ucob(2) .or.             &
  639.        imgpos(3) .eq. lcob(3))                 &
  640.    then
  641.      z1 = imgpos1pls1
  642.      z2 = imgpos2pls1
  643.      z3 = imgpos3mns1
  644.      if (z1 .gt. ucob(1)) z1 = lcob(1)
  645.      if (z2 .gt. ucob(2)) z2 = lcob(2)
  646.      if (z3 .lt. lcob(3)) z3 = ucob(3)
  647.      coarray(ubv(1),ubv(2),lbv(3),:) =         &
ftn-6202 ftn: VECTOR File = cgca_m2hx.f90, Line = 647 
  A loop starting at line 647 was replaced by a library call.

  648.      coarray(lbr(1),lbr(2),ubr(3),:) [z1,z2,z3]
  649.    end if
  650.    
  651.    ! corner 5
  652.    if (imgpos(1) .eq. lcob(1) .or.             &
  653.        imgpos(2) .eq. lcob(2) .or.             &
  654.        imgpos(3) .eq. ucob(3))                 &
  655.    then
  656.      z1 = imgpos1mns1
  657.      z2 = imgpos2mns1
  658.      z3 = imgpos3pls1
  659.      if (z1 .lt. lcob(1)) z1 = ucob(1)
  660.      if (z2 .lt. lcob(2)) z2 = ucob(2)
  661.      if (z3 .gt. ucob(3)) z3 = lcob(3)
  662.      coarray(lbv(1),lbv(2),ubv(3),:) =         &
ftn-6202 ftn: VECTOR File = cgca_m2hx.f90, Line = 662 
  A loop starting at line 662 was replaced by a library call.

  663.      coarray(ubr(1),ubr(2),lbr(3),:) [z1,z2,z3]
  664.    end if
  665.    
  666.    ! corner 6
  667.    if (imgpos(1) .eq. ucob(1) .or.             &
  668.        imgpos(2) .eq. lcob(2) .or.             &
  669.        imgpos(3) .eq. ucob(3))                 &
  670.    then
  671.      z1 = imgpos1pls1
  672.      z2 = imgpos2mns1
  673.      z3 = imgpos3pls1
  674.      if (z1 .gt. ucob(1)) z1 = lcob(1)
  675.      if (z2 .lt. lcob(2)) z2 = ucob(2)
  676.      if (z3 .gt. ucob(3)) z3 = lcob(3)
  677.      coarray(ubv(1),lbv(2),ubv(3),:) =         &
ftn-6202 ftn: VECTOR File = cgca_m2hx.f90, Line = 677 
  A loop starting at line 677 was replaced by a library call.

  678.      coarray(lbr(1),ubr(2),lbr(3),:) [z1,z2,z3]
  679.    end if
  680.    
  681.    ! corner 7
  682.    if (imgpos(1) .eq. lcob(1) .or.             &
  683.        imgpos(2) .eq. ucob(2) .or.             &
  684.        imgpos(3) .eq. ucob(3))                 &
  685.    then
  686.      z1 = imgpos1mns1
  687.      z2 = imgpos2pls1
  688.      z3 = imgpos3pls1
  689.      if (z1 .lt. lcob(1)) z1 = ucob(1)
  690.      if (z2 .gt. ucob(2)) z2 = lcob(2)
  691.      if (z3 .gt. ucob(3)) z3 = lcob(3)
  692.      coarray(lbv(1),ubv(2),ubv(3),:) =         &
ftn-6202 ftn: VECTOR File = cgca_m2hx.f90, Line = 692 
  A loop starting at line 692 was replaced by a library call.

  693.      coarray(ubr(1),lbr(2),lbr(3),:) [z1,z2,z3]
  694.    end if
  695.    
  696.    ! corner 8
  697.    if (imgpos(1) .eq. ucob(1) .or.             &
  698.        imgpos(2) .eq. ucob(2) .or.             &
  699.        imgpos(3) .eq. ucob(3))                 &
  700.    then
  701.      z1 = imgpos1pls1
  702.      z2 = imgpos2pls1
  703.      z3 = imgpos3pls1
  704.      if (z1 .gt. ucob(1)) z1 = lcob(1)
  705.      if (z2 .gt. ucob(2)) z2 = lcob(2)
  706.      if (z3 .gt. ucob(3)) z3 = lcob(3)
  707.      coarray(ubv(1),ubv(2),ubv(3),:) =         &
ftn-6202 ftn: VECTOR File = cgca_m2hx.f90, Line = 707 
  A loop starting at line 707 was replaced by a library call.

  708.      coarray(lbr(1),lbr(2),lbr(3),:) [z1,z2,z3]
  709.    end if
  710.    
  711.    end subroutine cgca_hxg
  712.    
  713.    !*roboend*
  714.    
  715.    end module cgca_m2hx


%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
                         E x t e r n a l   R e p o r t
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

Name  Messages
----  --------
ABORT
      Defined as:  No definitions.

                   No calls.  It is not called and does not use any procedure.

      Interface:   None

Name  Messages
----  --------
ABORT(Intrinsic)
      Defined as:  No definitions.

                   No calls.  It is not called and does not use any procedure.

      Interface:   None

Name  Messages
----  --------
ALLOCATED(Intrinsic)
      Defined as:  No definitions.

      Interface:   None

      Called By:   CGCA_HXI in CGCA_M2HX (Line 80, file cgca_m2hx.f90)
                   CGCA_HXG in CGCA_M2HX (Line 311, file cgca_m2hx.f90)

Name  Messages
----  --------
CGCA_HXG in CGCA_M2HX
      Defined as:  Subroutine (line 28, file cgca_m2hx.f90)

      Interface:   None

      Calls:       ALLOCATED(Intrinsic) (Line 311, file cgca_m2hx.f90)
                   LBOUND(Intrinsic) (Line 314, file cgca_m2hx.f90)
                   UBOUND(Intrinsic) (Line 315, file cgca_m2hx.f90)
                   LCOBOUND(Intrinsic) (Line 318, file cgca_m2hx.f90)
                   UCOBOUND(Intrinsic) (Line 319, file cgca_m2hx.f90)
                   THIS_IMAGE(Intrinsic) (Line 321, file cgca_m2hx.f90)

Name  Messages
----  --------
CGCA_HXI in CGCA_M2HX
      Defined as:  Subroutine (line 28, file cgca_m2hx.f90)

      Interface:   None

      Calls:       ALLOCATED(Intrinsic) (Line 80, file cgca_m2hx.f90)
                   LBOUND(Intrinsic) (Line 83, file cgca_m2hx.f90)
                   UBOUND(Intrinsic) (Line 84, file cgca_m2hx.f90)
                   LCOBOUND(Intrinsic) (Line 87, file cgca_m2hx.f90)
                   UCOBOUND(Intrinsic) (Line 88, file cgca_m2hx.f90)
                   THIS_IMAGE(Intrinsic) (Line 90, file cgca_m2hx.f90)

Name  Messages
----  --------
CGCA_M1CO
      Defined as:  No definitions.

      Used By:     CGCA_M2HX

Name  Messages
----  --------
CGCA_M2HX
      Defined as:  Module (line 8, file cgca_m2hx.f90)

        Uses:      CGCA_M1CO
                   ISO_FORTRAN_ENV  (indirectly)

Name  Messages
----  --------
EXIT(Intrinsic)
      Defined as:  No definitions.

                   No calls.  It is not called and does not use any procedure.

      Interface:   None

Name  Messages
----  --------
FLUSH
      Defined as:  No definitions.

                   No calls.  It is not called and does not use any procedure.

      Interface:   None

Name  Messages
----  --------
FLUSH(Intrinsic)
      Defined as:  No definitions.

                   No calls.  It is not called and does not use any procedure.

      Interface:   None

Name  Messages
----  --------
FLUSH_8
      Defined as:  No definitions.

                   No calls.  It is not called and does not use any procedure.

      Interface:   None

Name  Messages
----  --------
FTN_LIB_DEFINITIONS
      Defined as:  No definitions.

                   No calls.  It is not called and does not use any procedure.

Name  Messages
----  --------
HUGE(Intrinsic)
      Defined as:  No definitions.

                   No calls.  It is not called and does not use any procedure.

      Interface:   None

Name  Messages
----  --------
ICEIL
      Defined as:  No definitions.

                   No calls.  It is not called and does not use any procedure.

      Interface:   None

Name  Messages
----  --------
ICEIL_J
      Defined as:  No definitions.

                   No calls.  It is not called and does not use any procedure.

      Interface:   None

Name  Messages
----  --------
ISO_FORTRAN_ENV
      Defined as:  No definitions.

      Used By:     CGCA_M2HX  (indirectly)

Name  Messages
----  --------
KIND(Intrinsic)
      Defined as:  No definitions.

                   No calls.  It is not called and does not use any procedure.

      Interface:   None

Name  Messages
----  --------
LBOUND(Intrinsic)
      Defined as:  No definitions.

      Interface:   None

      Called By:   CGCA_HXI in CGCA_M2HX (Line 83, file cgca_m2hx.f90)
                   CGCA_HXG in CGCA_M2HX (Line 314, file cgca_m2hx.f90)

Name  Messages
----  --------
LCOBOUND(Intrinsic)
      Defined as:  No definitions.

      Interface:   None

      Called By:   CGCA_HXI in CGCA_M2HX (Line 87, file cgca_m2hx.f90)
                   CGCA_HXG in CGCA_M2HX (Line 318, file cgca_m2hx.f90)

Name  Messages
----  --------
SELECTED_INT_KIND(Intrinsic)
      Defined as:  No definitions.

                   No calls.  It is not called and does not use any procedure.

      Interface:   None

Name  Messages
----  --------
SELECTED_REAL_KIND(Intrinsic)
      Defined as:  No definitions.

                   No calls.  It is not called and does not use any procedure.

      Interface:   None

Name  Messages
----  --------
SIZE(Intrinsic)
      Defined as:  No definitions.

                   No calls.  It is not called and does not use any procedure.

      Interface:   None

Name  Messages
----  --------
THIS_IMAGE(Intrinsic)
      Defined as:  No definitions.

      Interface:   None

      Called By:   CGCA_HXI in CGCA_M2HX (Line 90, file cgca_m2hx.f90)
                   CGCA_HXG in CGCA_M2HX (Line 321, file cgca_m2hx.f90)

Name  Messages
----  --------
UBOUND(Intrinsic)
      Defined as:  No definitions.

      Interface:   None

      Called By:   CGCA_HXI in CGCA_M2HX (Line 84, file cgca_m2hx.f90)
                   CGCA_HXG in CGCA_M2HX (Line 315, file cgca_m2hx.f90)

Name  Messages
----  --------
UCOBOUND(Intrinsic)
      Defined as:  No definitions.

      Interface:   None

      Called By:   CGCA_HXI in CGCA_M2HX (Line 88, file cgca_m2hx.f90)
                   CGCA_HXG in CGCA_M2HX (Line 319, file cgca_m2hx.f90)


%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
